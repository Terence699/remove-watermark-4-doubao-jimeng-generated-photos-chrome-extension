# 豆包即梦图片去水印下载 Chrome 插件

## 项目目标

开发一个 Chrome 浏览器扩展，帮助用户在豆包（https://www.doubao.com）和即梦（https://jimeng.jianying.com）网页上下载图片时，自动去除图片上的水印，并保存为本地图片。

## 主要功能

1. **多网站支持**：自动检测豆包和即梦网站，使用不同的图片选择器。
2. **智能显示**：只在大图模式下显示下载按钮，列表页面不显示。
3. **自动去水印**：针对不同网站采用不同的水印去除策略。
4. **优雅交互**：
   - 豆包：紫蓝色渐变按钮
   - 即梦：天蓝色渐变按钮
5. **智能清理**：按钮会根据图片状态自动显示/隐藏，不会残留。
6. **直接下载**：处理后的图片直接下载到本地，无需跳转新标签页。

## 使用方法

1. 安装本扩展后，访问豆包或即梦网页。
2. 点击打开大图模式。
3. 在图片右上角会出现"去水印下载"按钮。
4. 点击按钮即可自动下载去除水印后的图片。

## 技术实现

- **Manifest V3**：使用最新的Chrome扩展规范。
- **最小权限原则**：仅使用必要的host_permissions，无需activeTab或scripting权限。
- **Content Scripts**：智能注入页面，符合Chrome Web Store政策要求。
- **图片处理**：
  - 豆包：Canvas处理，去除右下角15%区域水印
  - 即梦：fetch直接下载 + webp转png + 去除右下角12%区域水印
- **按钮管理**：使用WeakSet和Map进行智能的按钮生命周期管理。
- **响应式设计**：支持不同分辨率，按钮自动跟随图片位置。

## 权限说明

本扩展严格遵循最小权限原则，仅请求必要权限：

- **host_permissions**：
  - `https://www.doubao.com/*` - 访问豆包网站
  - `https://jimeng.jianying.com/*` - 访问即梦网站
- **无需其他权限**：不使用activeTab、scripting等可能被认为过度的权限

## 图标设计

### 设计理念

- **极简主义**：简洁的几何形状，现代化设计
- **高级感**：渐变色彩，微妙的光影效果
- **功能性**：图片框架 + 下载箭头，直观表达功能

### 设计元素

- **背景**：紫蓝渐变圆形，呼应按钮配色
- **图片框架**：白色描边矩形，圆角设计
- **风景示意**：简化的山峦和太阳，表示图片内容
- **下载箭头**：现代化的下载图标
- **动画效果**：`icon.svg`包含微妙的清洁效果动画

### 文件说明

- `icon.svg`：主设计文件（128x128，包含动画）
- `icon16.png`、`icon48.png`、`icon128.png`：静态版本，用于Chrome扩展

## 文件结构

```
├── manifest.json          # Chrome扩展配置
├── contentScript.js        # 主要功能脚本
├── icon.svg              # 源图标文件（动画版）
├── icon16.png            # 16x16图标
├── icon48.png            # 48x48图标
├── icon128.png           # 128x128图标
├── privacy-policy.md     # 隐私政策
└── README.md             # 项目说明
```

## 安装方法

1. 打开Chrome浏览器的扩展管理页面（chrome://extensions/）
2. 开启"开发者模式"
3. 点击"加载已解压的扩展程序"
4. 选择本项目文件夹

## 支持的网站

- ✅ **豆包**（doubao.com）：智能去水印，Canvas处理
- ✅ **即梦**（jimeng.jianying.com）：webp转换，直接下载

## 技术特色

- **零配置**：安装即用，无需用户设置
- **智能识别**：自动检测网站类型和图片模式
- **优雅降级**：处理失败时自动下载原图
- **内存优化**：使用WeakSet避免内存泄漏
- **实时清理**：MutationObserver + 防抖机制
- **权限最小化**：符合Chrome Web Store最佳实践

## 版本更新

### v1.0.1 (2024-05-30)
- 🔧 **权限优化**：移除不必要的activeTab和scripting权限
- 🗑️ **代码清理**：移除空的Service Worker
- ✅ **合规性**：符合Chrome Web Store权限政策要求

### v1.0.0 (2024-05-29)
- 🎉 **初始版本**：支持豆包和即梦两个网站
- 🎨 **优雅UI**：现代化按钮设计和交互
- 🧠 **智能检测**：大图模式自动识别
- 🎯 **精准去水印**：针对不同网站的优化策略

## 后续优化建议

- 支持更多AI图片生成网站
- 增加自定义水印去除区域设置
- 添加Side Panel管理下载历史
- 支持批量下载功能
- 优化不同水印位置的识别算法

---

**开发者**：Terence Y  
**版本**：1.0.1  
**许可证**：MIT
